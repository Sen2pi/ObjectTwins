<!doctype html>
<html lang="pt-PT">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Wiki — ObjectTwins: Subsistemas</title>
  <style>
    body { font-family: Segoe UI, Roboto, Arial, sans-serif; margin: 0; }
    header { padding: 12px 16px; background: #0b5cff; color: #fff; }
    main { padding: 16px; display: grid; gap: 24px; }
    .section { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; align-items: start; }
    .code { background: #f5f7fb; padding: 12px; overflow: auto; }
    .right { display: grid; gap: 12px; }
    .right img { width: 100%; height: auto; border: 0; }
    .desc { background: #fff; border: 1px solid #e5e7ef; padding: 12px; }
    h2 { margin: 8px 0; }
    @media (max-width: 900px) { .section { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <header>Wiki — ObjectTwins Activity Provider</header>
  <main>
    <section class="section" id="sistema">
      <div class="code">
        <pre>@startuml
skinparam componentStyle uml2
skinparam defaultTextAlignment center
left to right direction
component "«subsystem» ObjectTwins" as ObjectTwinsSystem { port PortoInvenRA }
note right of PortoInvenRA : Canal externo para Inven!RA
component "Inven!RA" as InvenRA { interface IAutenticaçãoInvenRA }
note right of IAutenticaçãoInvenRA : Autenticação com Inven!RA
component "GestorAnalytics" as GestorAnalytics { interface IDadosAnalíticos }
note right of IDadosAnalíticos : Dados analíticos
PortoInvenRA -left-0 IDadosAnalíticos
InvenRA ..> IConfiguraçãoAtividade
GestorAnalytics --> PortoInvenRA : [delegate] IDadosAnalíticos
@enduml</pre>
      </div>
      <div class="right">
        <img alt="Sistema ObjectTwins">
        <div class="desc">
          <h2>Sistema</h2>
          <p>O sistema «subsystem» ObjectTwins comunica com Inven!RA através de PortoInvenRA. Recebe IConfiguraçãoAtividade e publica IDadosAnalíticos.</p>
        </div>
      </div>
    </section>
    <section class="section" id="apresentacao">
      <div class="code">
        <pre>@startuml
skinparam componentStyle uml2
skinparam defaultTextAlignment center
left to right direction
component "«subsystem» Camada de Apresentação" as SubApresentacao #E8F1FF {
  component "«component» Visualizador3D" as Visualizador3D #90CAF9 {
    port PortoUI
    note right of PortoUI : Interação e renderização UI
    interface IVisualização
    note right of IVisualização : Interface de visualização 3D
  }
}
Visualizador3D -left-0 IVisualização
@enduml</pre>
      </div>
      <div class="right">
        <img alt="Camada de Apresentação">
        <div class="desc">
          <h2>Camada de Apresentação</h2>
          <p>Renderiza modelos 3D e o estado da simulação em tempo real. Fornece IVisualização e requer IDadosSimulação e IModelos3D.</p>
        </div>
      </div>
    </section>

    <section class="section" id="gestao">
      <div class="code">
        <pre>@startuml
skinparam componentStyle uml2
skinparam defaultTextAlignment center
left to right direction
component "«subsystem» Camada de Gestão" as SubGestao #E8F5E9 {
  component "«component» GestorSessão" as GestorSessao #A5D6A7 {
    interface IControleSessão
    note right of IControleSessão : Controlo de sessão
    interface IGestãoUtilizador
    note right of IGestãoUtilizador : Gestão de utilizador
    interface IDadosSessão
    note right of IDadosSessão : Dados da sessão
  }
  component "«component» GestorAnalytics" as GestorAnalytics #A5D6A7 {
    interface IMétricasQuantitativas
    note right of IMétricasQuantitativas : Métricas quantitativas
    interface IRelatóriosQualitativos
    note right of IRelatóriosQualitativos : Relatórios qualitativos
    interface IDadosAnalíticos
    note right of IDadosAnalíticos : Dados analíticos
  }
}
GestorSessao - IControleSessão
GestorSessao - IGestãoUtilizador
GestorAnalytics -left-0 IMétricasQuantitativas
GestorAnalytics -left-0 IRelatóriosQualitativos
GestorAnalytics -left-0 IDadosAnalíticos
@enduml</pre>
      </div>
      <div class="right">
        <img alt="Camada de Gestão">
        <div class="desc">
          <h2>Camada de Gestão</h2>
          <p>Orquestra sessões e utilizadores, expõe controlo e recolhe/produz analítica. Publica IDadosAnalíticos para o exterior.</p>
        </div>
      </div>
    </section>

    <section class="section" id="criacao">
      <div class="code">
        <pre>@startuml
skinparam componentStyle uml2
skinparam defaultTextAlignment center
left to right direction
component "«subsystem» Camada de Criação e Configuração" as SubCriacao #FFF3E0 {
  component "«component» CriadorObjetos" as CriadorObjetos #FFCC80 {
    interface ICriaçãoObjetos
    note right of ICriaçãoObjetos : Criação de objetos
    interface IModelagem3D
    note right of IModelagem3D : Modelagem 3D
    interface IDadosObjetos
    note right of IDadosObjetos : Dados de objetos
    interface IPropriedadesObjetos
    note right of IPropriedadesObjetos : Propriedades dos objetos
  }
  component "«component» GestorMateriais" as GestorMateriais #FFCC80 {
    interface IBaseDadosMateriais
    note right of IBaseDadosMateriais : Base de dados de materiais
    interface IPropriedadesFísicas
    note right of IPropriedadesFísicas : Propriedades físicas
    interface IDadosMateriais
    note right of IDadosMateriais : Dados de materiais
    interface IPropriedadesMateriais
    note right of IPropriedadesMateriais : Propriedades de materiais
  }
}
CriadorObjetos -left-0 ICriaçãoObjetos
CriadorObjetos -left-0 IModelagem3D
GestorMateriais -left-0 IBaseDadosMateriais
GestorMateriais -left-0 IPropriedadesFísicas
CriadorObjetos ..> IDadosMateriais
@enduml</pre>
      </div>
      <div class="right">
        <img alt="Camada de Criação e Configuração">
        <div class="desc">
          <h2>Criação e Configuração</h2>
          <p>Cria objetos e modelos 3D com base em materiais. GestorMateriais fornece o catálogo e propriedades físicas.</p>
        </div>
      </div>
    </section>

    <section class="section" id="simulacao">
      <div class="code">
        <pre>@startuml
skinparam componentStyle uml2
skinparam defaultTextAlignment center
left to right direction
component "«subsystem» Camada de Simulação e Análise" as SubSimulacao #F3E5F5 {
  component "«component» MotorSimulação" as MotorSimulacao #CE93D8 {
    interface ISimulaçãoFísica
    note right of ISimulaçãoFísica : Simulação física
    interface IConfiguraçãoAmbiente
    note right of IConfiguraçãoAmbiente : Configuração de ambiente
    interface IDadosSimulação
    note right of IDadosSimulação : Dados da simulação
    interface IResultadosSimulação
    note right of IResultadosSimulação : Resultados da simulação
    interface IEstadoSimulação
    note right of IEstadoSimulação : Estado da simulação
  }
  component "«component» Detetor Colisões" as DetetorColisoes #CE93D8 {
    interface IDeteçãoColisões
    note right of IDeteçãoColisões : Deteção de colisões
    interface ICálculoDanos
    note right of ICálculoDanos : Cálculo de danos
    interface IDadosColisões
    note right of IDadosColisões : Dados de colisões
  }
  component "«component» AnalisadorResultados" as AnalisadorResultados #CE93D8 {
    interface IAnáliseDesempenho
    note right of IAnáliseDesempenho : Análise de desempenho
    interface IEstatísticas
    note right of IEstatísticas : Estatísticas
    interface IResultadosAnálise
    note right of IResultadosAnálise : Resultados de análise
  }
}
MotorSimulacao -left-0 ISimulaçãoFísica
MotorSimulacao -left-0 IConfiguraçãoAmbiente
DetetorColisoes -left-0 IDeteçãoColisões
DetetorColisoes -left-0 ICálculoDanos
AnalisadorResultados -left-0 IAnáliseDesempenho
AnalisadorResultados -left-0 IEstatísticas
@enduml</pre>
      </div>
      <div class="right">
        <img alt="Camada de Simulação e Análise">
        <div class="desc">
          <h2>Simulação e Análise</h2>
          <p>Executa a simulação física, deteta colisões e calcula danos, gerando análises e estatísticas dos resultados.</p>
        </div>
      </div>
    </section>

    <section class="section" id="exportacao">
      <div class="code">
        <pre>@startuml
skinparam componentStyle uml2
skinparam defaultTextAlignment center
top to bottom direction
component "«subsystem» Camada de Exportação" as SubExportacao #E0F2F1 {
  component "«component» ExportadorDados" as ExportadorDados #80CBC4 {
    interface IExportaçãoCSV
    note right of IExportaçãoCSV : Exportação em CSV
    interface IExportaçãoJSON
    note right of IExportaçãoJSON : Exportação em JSON
    interface IDadosExportação
    note right of IDadosExportação : Dados de exportação
  }
}
ExportadorDados -left-0 IExportaçãoCSV
ExportadorDados -left-0 IExportaçãoJSON
@enduml</pre>
      </div>
      <div class="right">
        <img alt="Camada de Exportação">
        <div class="desc">
          <h2>Exportação</h2>
          <p>Exporta resultados de análise em formatos CSV e JSON para integração e partilha externa.</p>
        </div>
      </div>
    </section>
  </main>
  <script src="https://unpkg.com/plantuml-encoder/dist/plantuml-encoder.min.js"></script>
  <script>
    document.querySelectorAll('.section').forEach(sec => {
      const pre = sec.querySelector('pre');
      const img = sec.querySelector('img');
      const encoded = window.plantumlEncoder.encode(pre.textContent.trim());
      const tryEndpoints = [
        'https://kroki.io/plantuml/png/',
        'https://www.plantuml.com/plantuml/png/',
        'https://plantuml.online/uml/'
      ];
      let i = 0;
      function setNext(){
        if(i>=tryEndpoints.length){
          img.alt += ' (abrir manualmente)';
          return;
        }
        img.src = tryEndpoints[i] + encoded;
        img.onerror = function(){ i++; setNext(); };
      }
      setNext();
    });
  </script>
</body>
</html>
